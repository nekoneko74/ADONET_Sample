# ADONET_Sampleプロジェクト
ADO.NETによるSQL Serverデータベース操作アプリケーションのサンプルです。
SQL Server Management StudioやVisual StudioのTransact-SQLエディターなどでデータベーステーブルの現在の状態を確認しながら動作させていきます。

プロジェクトの基本情報は以下の通りです。
* 対象のフレームワーク：.NET Framework 4.8
* 出力の種類：コンソール アプリケーション
* 対象プラットフォーム：Any CPU

## SQL Serverデータベース
このサンプルプログラムで使用するSQL Serverデータベースの情報は以下の通りです。
プログラムが動作する環境と同じホスト（localhost）でSQL Serverが動作していて、そのSQL Serverに「ADONET」というデータベースが存在していることを確認してください。
また、その「ADONET」データベースに、ログイン名「sa」でアクセスできること、及びそのログイン名「sa」のパスワードが「P@ssword」となっていることを確認してください。

|項目|値|
|---|---|
|SQL Serverホスト名|localhost|
|使用するデータベース|ADONET|
|ログイン名|sa|
|パスワード|P@ssword|

［MyTable］テーブル

|カラム|データ型|制約|
|---|---|---|
|IntData|int|PRIMARY KEY|
|DoubleData|float|
|DecimalData|decimal(10, 4)||
|StringData|nvarchar(50)||
|DatetimeData|date||
|BoolData|bit||

## データベーステーブル生成スクリプト（Databaseフォルダ）
#### MyTable.sql
サンプルデータベーステーブル［MyTable］の作成とサンプルデータの挿入クエリです。
このスクリプトを再実行することで、データベーステーブルの更新処理を行った結果をリセットすることができます。

## サンプルプログラム（Sampleフォルダ）
### データベースマネージメントシステム（SQL Server）との接続を管理する
SQL Serverへの接続を管理するサンプルプログラムです。
#### Sample01.cs
- 接続文字列を使用してSQL Serverに接続します。
#### Sample02.cs
- SqlConnectionStringBuilderクラスを使用して接続文字列を生成します。
- 接続文字列をSqlConnectionクラスのコンストラクタに設定します。

### データベースの参照処理（接続型）
データベーステーブルの参照を行うサンプルプログラムです。
この例のようにデータベースへの接続／切断をプログラム自身で管理する形式を「接続型」と呼びます。
#### Sample03.cs
- データベーステーブルから複数のレコードを参照します（接続型）。
- SqlCommand.ExecuteReader()メソッドを使用してデータベーステーブルからレコードを参照します。
- SqlDataReaderオブジェクトを使用して選択されたレコードからフィールドのデータを取得します。
- データベーステーブルから取得した各フィールドのデータを.NET Frameworkプログラムの変数に変換して取り込みます。
#### Sample04.cs
- データベーステーブルから指定された条件に合致するレコードのみを参照します（接続型）。
- パラメータを使用してプログラムからSqlCommandオブジェクト内のSQL文に値を引き渡します。
#### Sample05.cs
- Sample03におけるデータ型変換の別バージョンです。
- データベーステーブルから取得した各フィールドのデータをasキャストを使用して変換・取り込みます。

### データベースの更新処理（接続型）
データベースの更新処理を行うサンプルプログラムです。
#### Sample06.cs
- データベーステーブルにレコードを挿入します（接続型）。
- SqlCommand.ExecuteNonQuery()メソッドを使用してデータベースレコードを更新します。
#### Sample07.cs
- データベーステーブルのレコードを更新します（接続型）。
#### Sample08.cs
- データベーステーブルのレコードを削除します（接続型）。

### 非接続型によるデータベースの参照処理
非接続型によるデータベーステーブルの参照処理のサンプルプログラムです。
SqlDataAdapterオブジェクトが必要に応じてデータベースに接続／切断を行います。
この例のようにデータベースへの接続／切断をプログラム自身では管理しない形式を「非接続型」と呼びます。
#### Sample09.cs
- データベーステーブルから複数のレコードを参照します（非接続型）。
- SqlDataAdapterおよびDataTable／DataRowオブジェクトを使用してデータベーステーブルからレコードを参照します。
#### Sample10.cs
- データベーステーブルから指定された条件に合致するレコードのみを参照します（非接続型）。
- パラメータを使用してプログラムからSqlDataAdapter内のSqlCommandオブジェクト内のSQL文に値を引き渡します。

### 非接続型によるデータベースの更新処理
非接続型によるデータベーステーブルの更新処理のサンプルプログラムです。
#### Sample11.cs
- 非接続型でデータベーステーブルにレコードを挿入します。
- 非接続型でデータベーステーブルのレコードを更新します。
- 非接続型でデータベーステーブルのレコードを削除します。
#### Sample12.cs
- SqlCommandBuilderを使用して非接続型でのデータベーステーブルの更新処理を行います。

### 例外処理／リソース管理
例外処理／リソースの後処理を追加したサンプルプログラムです。
#### Sample13.cs
- 例外処理を使用してデータベースで発生したエラーを検知して対応を行います。
#### Sample14.cs
- usingステートメントを使用してリソースの後処理を行います。
#### Sample15.cs
- SqlTransactionオブジェクトを使用してトランザクションを管理します。
- null条件演算子を使用すれば記述を簡略化することができます。
#### Sample16.cs
- TransactionScopeオブジェクトを使用してトランザクションを管理します。

### DAO／DTOパターン
DAO／DTOパターンによるデータベース処理を行うサンプルプログラムです。
データ操作処理をアプリケーションで使用しやすい形にまとめたDAO（Data Access Object）と、
データを格納して持ち運ぶ役割を果たすDTO（Data Transfer Object）を組み合わせてプログラムを構成します。
DaoDtoフォルダに格納された以下の3つのファイルで構成されています。
- SampleDao.cs ⇒ MyTableDao/MyTableDtoを使用するメインメソッドが格納されています。
- MyTableDao.cs ⇒ MyTableテーブルに対する各種操作を持つDAOです。
- MyTableDto.cs ⇒ MyTableテーブルの1レコードを格納できるDTOです。